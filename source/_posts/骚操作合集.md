---
title: 夕顔 | 骚操作合集
date: 2018-03-17 10:42:34
tags:
---
reducer里，如果我们想删除一项，进行如下操作。妈妈再也不用担心我拷贝对象了。
```javascript
const removeQuestion = (state, action) => {
const { id } = action.payload

// 原来我们需要这么做
const newState = Object.assign({}, state)
delete newState[id]
return newState
}

// 现在我们可以这么做
return (({ [id]: deleted, ...newState }) => newState)(state)
```
此处巧妙地运用对象的解构赋值对属性进行过滤。

---

看高阶函数的时候对下面一段代码印象深刻。实在精妙。
```javascript
    Function.prototype.before = function(beforefn) {
        const __self = this // this -> 调用该函数的对象 -> 即func
        return function() { // this -> window
            beforefn.apply(this, arguments) // window调用beforefn
            return __self.apply(this, arguments) // window调用func 返回值为func()的返回值
        }
    }

    Function.prototype.after = function(afterfn) {
        const __self = this // 调用该函数的对象 -> 即调用 func.before() 返回的函数
        return function() { // [入口] 最后func()调用的是该函数 this -> window
            const ret = __self.apply(this, arguments) // window 调用 func.before() 返回的函数  ret为func()的返回值
            afterfn.apply(this, arguments) // window调用afterfn
            return ret // [出口]返回func()的返回值
        }
    }

    let func = function() {
        console.log(2)
        return 'i am ret'
    }

    func = func.before(function(){
        console.log(1)
    }).after(function() {
        console.log(3)
    })

    func()
```